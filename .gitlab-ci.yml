variables:
  MAVEN_OPTS: "-Dmaven.repo.local=.m2/repository -Dmaven.artifact.threads=50"

include:
  - local: edo-common/.gitlab-ci.yml

cache:
  paths:
    - ./.m2/repository
  key: project-cache

stages:
  - build_artifacts

.build-module:
  image: maven:3.6.3-openjdk-17-slim
  stage: build_artifacts
  tags:
    - runner
  script:
    - echo "Building $MODULE"
    - mvn $MODULE clean compile --also-make
  artifacts:
    expire_in: 10 min
    paths:
      - "*/target"

build_common:
  extends:
    - .common-module
    - .build-module

build_artifacts:
  extends:
    - .build-module
